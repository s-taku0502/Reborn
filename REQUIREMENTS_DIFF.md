# è¦ä»¶å®šç¾©æ›¸ã¨å®Ÿè£…ã®å·®ç•°ãƒ¬ãƒãƒ¼ãƒˆ

## å®Ÿæ–½æ—¥: 2026å¹´2æœˆ1æ—¥

---

## ğŸ”´ é‡å¤§ãªå·®ç•°ï¼ˆå®Ÿè£…å¿…é ˆï¼‰

### 1. **ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å†è¨­å®šï¼ˆæ–°è¦ç™ºè¡Œï¼‰æ©Ÿèƒ½ãŒæœªå®Ÿè£…**

#### è¦ä»¶å®šç¾©ï¼ˆÂ§4.3.3ï¼‰

```
- ãƒ­ã‚°ã‚¤ãƒ³ä¸­ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã¿å®Ÿè¡Œå¯èƒ½
- æ—¢å­˜ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã®ç¢ºèªï¼ˆè¡¨ç¤ºï¼‰ã¯ä¸€åˆ‡è¡Œã‚ãªã„
- æ–°ã—ã„7æ–‡å­—ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’è¨­å®šã—ãŸæ™‚ç‚¹ã§ã€æ—§ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã¯å³æ™‚ç„¡åŠ¹åŒ–
```

#### ç¾åœ¨ã®å®Ÿè£…çŠ¶æ…‹

- âŒ **ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å†è¨­å®šæ©Ÿèƒ½ãŒå­˜åœ¨ã—ãªã„**
- âŒ ãƒã‚¤ãƒšãƒ¼ã‚¸ã«ã€Œãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å†è¨­å®šã€ãƒœã‚¿ãƒ³ãŒãªã„
- âš ï¸ ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—æ™‚ã«ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒå¹³æ–‡ã§å«ã¾ã‚Œã¦ã„ã‚‹ï¼ˆã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒªã‚¹ã‚¯ï¼‰

#### å½±éŸ¿

- ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å¿˜ã‚ŒãŸå ´åˆã€å¾©å…ƒä¸å¯èƒ½
- è¦ä»¶å®šç¾© Â§4.3.3 ãŠã‚ˆã³ Â§4.3.4 ã® UXãƒ»ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£é…æ…®ãŒæœªå®Ÿè£…

---

### 2. **ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã®ä¿å­˜æ–¹æ³•ãŒã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¦ä»¶ã«é•å**

#### è¦ä»¶å®šç¾©ï¼ˆÂ§4.3.1ï¼‰

```
Firestore ã«ã¯ ãƒãƒƒã‚·ãƒ¥åŒ–ã—ã¦ä¿å­˜
```

#### ç¾åœ¨ã®å®Ÿè£…çŠ¶æ…‹

```typescript
// app/setup/page.tsx Line 43
localStorage.setItem('sanposhin_password', password); // æœ¬ç•ªç’°å¢ƒã§ã¯ãƒãƒƒã‚·ãƒ¥åŒ–å¿…é ˆ

// app/mypage/page.tsx Line 33
password: localStorage.getItem('sanposhin_password'),
```

- âŒ **å¹³æ–‡ã§ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã«ä¿å­˜ã•ã‚Œã¦ã„ã‚‹**
- âŒ ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ•ã‚¡ã‚¤ãƒ«ã«ã‚‚å¹³æ–‡ã§å«ã¾ã‚Œã¦ã„ã‚‹
- âš ï¸ ã‚³ãƒ¡ãƒ³ãƒˆã§ã€Œæœ¬ç•ªç’°å¢ƒã§ã¯ãƒãƒƒã‚·ãƒ¥åŒ–å¿…é ˆã€ã¨ã‚ã‚‹ãŒæœªå¯¾å¿œ

#### å½±éŸ¿

- ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒªã‚¹ã‚¯ï¼ˆãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã¯æš—å·åŒ–ã•ã‚Œã¦ã„ãªã„ï¼‰
- è¦ä»¶å®šç¾©ã®ã€Œãƒãƒƒã‚·ãƒ¥åŒ–ã—ã¦ä¿å­˜ã€ã«é•å

---

### 3. **ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ•ã‚¡ã‚¤ãƒ«ã«ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒå«ã¾ã‚Œã¦ã„ã‚‹**

#### è¦ä»¶å®šç¾©ã®æ„å›³

```
Â§4.3.3: æ—¢å­˜ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã®ç¢ºèªï¼ˆè¡¨ç¤ºï¼‰ã¯ä¸€åˆ‡è¡Œã‚ãªã„
```

#### ç¾åœ¨ã®å®Ÿè£…çŠ¶æ…‹

```typescript
// app/mypage/page.tsx Line 30-36
const handleBackup = () => {
  const data = {
    userId: localStorage.getItem('sanposhin_userId'),
    password: localStorage.getItem('sanposhin_password'), // â† ã“ã“ãŒå•é¡Œ
    logs: localStorage.getItem('sanposhin_logs'),
    createdAt: localStorage.getItem('sanposhin_createdAt'),
  };
  // ...JSONãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
};
```

- âŒ **ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ•ã‚¡ã‚¤ãƒ«ã«ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒå¹³æ–‡ã§å«ã¾ã‚Œã‚‹**
- âŒ ãƒ•ã‚¡ã‚¤ãƒ«ãŒæ¼æ´©ã—ãŸå ´åˆã€ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒéœ²å‡º

#### å½±éŸ¿

- ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒªã‚¹ã‚¯
- è¦ä»¶å®šç¾©ã®ã€Œç¢ºèªï¼ˆè¡¨ç¤ºï¼‰ä¸å¯ã€ã®ç²¾ç¥ã«åã™ã‚‹

---

## ğŸŸ¡ ä¸­ç¨‹åº¦ã®å·®ç•°ï¼ˆæ¨å¥¨å¯¾å¿œï¼‰

### 4. **å¾©å…ƒæ©Ÿèƒ½ãŒæœªå®Œæˆ**

#### è¦ä»¶å®šç¾©ï¼ˆÂ§4.4ï¼‰

```
- å¾©å…ƒå¤±æ•—3å›ã§ãƒ­ãƒƒã‚¯
- lockUntil = ç¾åœ¨æ™‚åˆ» + 60åˆ†
```

#### ç¾åœ¨ã®å®Ÿè£…çŠ¶æ…‹

```typescript
// app/mypage/page.tsx Line 51-61
const handleRestore = async () => {
  setError('');
  const storedUserId = localStorage.getItem('sanposhin_userId');
  const storedPassword = localStorage.getItem('sanposhin_password');

  if (restoreUserId !== storedUserId || restorePassword !== storedPassword) {
    setError('ãƒ¦ãƒ¼ã‚¶ãƒ¼IDã¾ãŸã¯ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒæ­£ã—ãã‚ã‚Šã¾ã›ã‚“');
    return;
  }

  alert('å¾©å…ƒæ©Ÿèƒ½ã¯é–‹ç™ºä¸­ã§ã™ã€‚\nç¾åœ¨ã¯ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰æ‰‹å‹•ã§å¾©å…ƒã§ãã¾ã™ã€‚');
};
```

- âš ï¸ **ã€Œé–‹ç™ºä¸­ã€ã‚¢ãƒ©ãƒ¼ãƒˆã§å®Ÿè³ªæœªå®Ÿè£…**
- âŒ å¤±æ•—å›æ•°ã‚«ã‚¦ãƒ³ãƒˆãƒ»ãƒ­ãƒƒã‚¯æ©Ÿèƒ½ãªã—
- âŒ Firestore ã¨ã®é€£æºãªã—ï¼ˆãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã®ã¿ï¼‰

---

### 5. **Firebaseï¼ˆFirestoreï¼‰é€£æºãŒæœªå®Ÿè£…**

#### è¦ä»¶å®šç¾©ï¼ˆÂ§3, Â§8ï¼‰

```
ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ / DB: Firebase (Firestore)
- ãƒ¦ãƒ¼ã‚¶ãƒ¼IDç®¡ç†
- ãŠå‘Šã’ãƒ†ã‚­ã‚¹ãƒˆãƒ»ãƒŸãƒƒã‚·ãƒ§ãƒ³æƒ…å ±
- å†’é™ºãƒ­ã‚°ã®æ„å‘³ãƒ‡ãƒ¼ã‚¿
```

#### ç¾åœ¨ã®å®Ÿè£…çŠ¶æ…‹

- âœ… Firebase SDK ã¯ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ¸ˆã¿
- âœ… `lib/firebase.ts` ã¯ä½œæˆæ¸ˆã¿
- âŒ **å®Ÿéš›ã®ãƒ‡ãƒ¼ã‚¿æ“ä½œã¯å…¨ã¦ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸**
- âŒ Firestore ã¸ã®ãƒ‡ãƒ¼ã‚¿ä¿å­˜ãƒ»å–å¾—ã¯æœªå®Ÿè£…

#### å½±éŸ¿

- ç«¯æœ«é–“ã§ã®ãƒ‡ãƒ¼ã‚¿åŒæœŸä¸å¯
- ãƒ¦ãƒ¼ã‚¶ãƒ¼IDé‡è¤‡ãƒã‚§ãƒƒã‚¯ä¸å¯
- çœŸã®ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ»å¾©å…ƒãŒä¸å¯èƒ½

---

## ğŸŸ¢ è»½å¾®ãªå·®ç•°ï¼ˆä»»æ„å¯¾å¿œï¼‰

### 6. **Cloudinary é€£æºãŒæœªå®Ÿè£…**

#### è¦ä»¶å®šç¾©ï¼ˆÂ§9.2ï¼‰

```
Cloudinary ã®å½¹å‰²:
- å†™çœŸãƒ•ã‚¡ã‚¤ãƒ«ã®ä¿å­˜
- è‡ªå‹•ãƒªã‚µã‚¤ã‚ºãƒ»åœ§ç¸®
- CDNé…ä¿¡
```

#### ç¾åœ¨ã®å®Ÿè£…çŠ¶æ…‹

```typescript
// app/record/page.tsx
// Base64ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã—ã¦ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã«ä¿å­˜
setImageData(reader.result as string);
```

- âš ï¸ **ç”»åƒãŒ Base64 ã§ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã«ä¿å­˜**
- âŒ Cloudinary ã¸ã®ç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ãªã—
- âš ï¸ ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸å®¹é‡ã«åˆ¶é™ï¼ˆãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã¯é€šå¸¸5-10MBï¼‰

#### å½±éŸ¿

- MVP ã¨ã—ã¦ã¯å‹•ä½œã™ã‚‹ãŒã€æ‹¡å¼µæ€§ã«æ¬ ã‘ã‚‹
- å¤šãã®å†™çœŸã‚’ä¿å­˜ã™ã‚‹ã¨å®¹é‡ä¸è¶³ã®å¯èƒ½æ€§

---

### 7. **Google Sheets é€£æºï¼ˆãŠé¡Œãƒã‚¹ã‚¿ãƒ¼ï¼‰ãŒæœªå®Ÿè£…**

#### è¦ä»¶å®šç¾©ï¼ˆÂ§3ï¼‰

```
ãŠé¡Œãƒã‚¹ã‚¿ãƒ¼: Google Sheets + GAS
```

#### ç¾åœ¨ã®å®Ÿè£…çŠ¶æ…‹

```typescript
// data/missions.json - é™çš„JSONãƒ•ã‚¡ã‚¤ãƒ«
```

- âœ… MVP ã¨ã—ã¦ JSON ã§ä»£æ›¿å®Ÿè£…æ¸ˆã¿
- âš ï¸ é‹ç”¨æ™‚ã®æ›´æ–°ãŒæ‰‹å‹•ï¼ˆè¦ãƒ‡ãƒ—ãƒ­ã‚¤ï¼‰
- âš ï¸ éã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã«ã‚ˆã‚‹æ›´æ–°ã¯ä¸å¯

---

## ğŸ“Š å·®ç•°ã‚µãƒãƒªãƒ¼

| é …ç›® | è¦ä»¶å®šç¾© | ç¾åœ¨ã®å®Ÿè£… | çŠ¶æ…‹ |
|-----|---------|----------|-----|
| ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰æ¡æ•° | 7æ¡ | âœ… 7æ¡ | OK |
| ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒãƒƒã‚·ãƒ¥åŒ– | å¿…é ˆ | âŒ å¹³æ–‡ | **NG** |
| ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å†è¨­å®š | å®Ÿè£… | âŒ æœªå®Ÿè£… | **NG** |
| ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—æ–¹å¼ | JSONï¼ˆãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãªã—æ¨å¥¨ï¼‰ | âŒ ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å«ã‚€ | **NG** |
| å¾©å…ƒå¤±æ•—ãƒ­ãƒƒã‚¯ | 3å›/60åˆ† | âŒ æœªå®Ÿè£… | è¦å¯¾å¿œ |
| Firebaseé€£æº | å¿…é ˆ | âŒ æœªå®Ÿè£… | è¦å¯¾å¿œ |
| Cloudinaryé€£æº | æ¨å¥¨ | âŒ æœªå®Ÿè£… | ä»»æ„ |
| ãƒ¦ãƒ¼ã‚¶ãƒ¼IDå½¢å¼ | è‹±å°æ–‡å­—ãƒ»æ•°å­—ãƒ»_ | âœ… å®Ÿè£…æ¸ˆã¿ | OK |
| ç¦æ­¢ID | äºˆç´„èªãƒªã‚¹ãƒˆ | âœ… å®Ÿè£…æ¸ˆã¿ | OK |

---

## ğŸ”§ æ¨å¥¨å¯¾å¿œé †åº

### Phase 1: ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¿®æ­£ï¼ˆæœ€å„ªå…ˆï¼‰

1. ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã®ãƒãƒƒã‚·ãƒ¥åŒ–å®Ÿè£…
2. ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰é™¤å¤–
3. ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å†è¨­å®šæ©Ÿèƒ½ã®è¿½åŠ 

### Phase 2: Firebaseé€£æºï¼ˆMVPå®Œæˆï¼‰

4. Firestore ã¸ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼IDç™»éŒ²
2. ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ã‚¿ã® Firestore ä¿å­˜
3. å¾©å…ƒæ©Ÿèƒ½ã®å®Œå…¨å®Ÿè£…ï¼ˆå¤±æ•—ãƒ­ãƒƒã‚¯å«ã‚€ï¼‰

### Phase 3: æ‹¡å¼µæ©Ÿèƒ½ï¼ˆä»»æ„ï¼‰

7. Cloudinary ç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
2. Google Sheets é€£æºï¼ˆãŠé¡Œãƒã‚¹ã‚¿ãƒ¼ï¼‰

---

## ğŸ’¡ å…·ä½“çš„ãªå®Ÿè£…ææ¡ˆ

### ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒãƒƒã‚·ãƒ¥åŒ–ï¼ˆbcrypt.jsä½¿ç”¨ï¼‰

```typescript
import bcrypt from 'bcryptjs';

// ä¿å­˜æ™‚
const hashedPassword = await bcrypt.hash(password, 10);
localStorage.setItem('sanposhin_password_hash', hashedPassword);

// æ¤œè¨¼æ™‚
const isValid = await bcrypt.compare(inputPassword, storedHash);
```

### ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å†è¨­å®šæ©Ÿèƒ½

```typescript
// ãƒã‚¤ãƒšãƒ¼ã‚¸ã«è¿½åŠ 
const handlePasswordReset = async (newPassword: string) => {
  const hashedPassword = await bcrypt.hash(newPassword, 10);
  localStorage.setItem('sanposhin_password_hash', hashedPassword);
  alert('æ–°ã—ã„ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å¿…ãšæ§ãˆã¦ãã ã•ã„: ' + newPassword);
};
```

---

**ä½œæˆæ—¥**: 2026å¹´2æœˆ1æ—¥  
**ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**: âš ï¸ é‡å¤§ãªå·®ç•°ã‚ã‚Šï¼ˆã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¯¾å¿œå¿…é ˆï¼‰
